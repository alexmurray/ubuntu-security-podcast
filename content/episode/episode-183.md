+++
title = "Episode 183"
description = """
  This week we look at a recent report from Elastic Security Labs on the global
  Linux threat landscape, plus we look at a few of the security vulnerabilities
  patched by the team in the past 7 days.
  """
date = 2022-12-02T17:48:00+10:30
lastmod = 2022-12-02T17:48:51+10:30
draft = false
weight = 1001
episode_image = "img/usp_logo_500.png"
explicit = "no"
podcast_file = "USP_E183.mp3"
podcast_duration = 810
podcast_bytes = 14460954
permalink = "https://ubuntusecuritypodcast.org/episode-183/"
guid = "a06e9819a73f35852cc208f51663d63d35295c3b7d0d6c1e429527c7b14d944e694b2daf9b7c680903915483cba822a2ea91098679e570c4b88c789aa76cfd71"
+++

## Overview {#overview}

This week we look at a recent report from Elastic Security Labs on the global
Linux threat landscape, plus we look at a few of the security vulnerabilities
patched by the team in the past 7 days.


## This week in Ubuntu Security Updates {#this-week-in-ubuntu-security-updates}

81 unique CVEs addressed


### [[USN-5638-3](https://ubuntu.com/security/notices/USN-5638-3)] Expat vulnerability {#usn-5638-3-expat-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM), Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2022-43680](https://ubuntu.com/security/CVE-2022-43680) <!-- medium -->


### [[USN-5739-1](https://ubuntu.com/security/notices/USN-5739-1)] MariaDB vulnerabilities {#usn-5739-1-mariadb-vulnerabilities}

-   36 CVEs addressed in Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2022-32091](https://ubuntu.com/security/CVE-2022-32091) <!-- medium -->
    -   [CVE-2022-32089](https://ubuntu.com/security/CVE-2022-32089) <!-- medium -->
    -   [CVE-2022-32088](https://ubuntu.com/security/CVE-2022-32088) <!-- medium -->
    -   [CVE-2022-32087](https://ubuntu.com/security/CVE-2022-32087) <!-- medium -->
    -   [CVE-2022-32086](https://ubuntu.com/security/CVE-2022-32086) <!-- medium -->
    -   [CVE-2022-32085](https://ubuntu.com/security/CVE-2022-32085) <!-- medium -->
    -   [CVE-2022-32084](https://ubuntu.com/security/CVE-2022-32084) <!-- medium -->
    -   [CVE-2022-32083](https://ubuntu.com/security/CVE-2022-32083) <!-- medium -->
    -   [CVE-2022-32082](https://ubuntu.com/security/CVE-2022-32082) <!-- medium -->
    -   [CVE-2022-32081](https://ubuntu.com/security/CVE-2022-32081) <!-- medium -->
    -   [CVE-2022-27458](https://ubuntu.com/security/CVE-2022-27458) <!-- medium -->
    -   [CVE-2022-27457](https://ubuntu.com/security/CVE-2022-27457) <!-- medium -->
    -   [CVE-2022-27456](https://ubuntu.com/security/CVE-2022-27456) <!-- medium -->
    -   [CVE-2022-27455](https://ubuntu.com/security/CVE-2022-27455) <!-- medium -->
    -   [CVE-2022-27452](https://ubuntu.com/security/CVE-2022-27452) <!-- medium -->
    -   [CVE-2022-27451](https://ubuntu.com/security/CVE-2022-27451) <!-- medium -->
    -   [CVE-2022-27449](https://ubuntu.com/security/CVE-2022-27449) <!-- medium -->
    -   [CVE-2022-27448](https://ubuntu.com/security/CVE-2022-27448) <!-- medium -->
    -   [CVE-2022-27447](https://ubuntu.com/security/CVE-2022-27447) <!-- medium -->
    -   [CVE-2022-27446](https://ubuntu.com/security/CVE-2022-27446) <!-- medium -->
    -   [CVE-2022-27445](https://ubuntu.com/security/CVE-2022-27445) <!-- medium -->
    -   [CVE-2022-27444](https://ubuntu.com/security/CVE-2022-27444) <!-- medium -->
    -   [CVE-2022-27387](https://ubuntu.com/security/CVE-2022-27387) <!-- medium -->
    -   [CVE-2022-27386](https://ubuntu.com/security/CVE-2022-27386) <!-- medium -->
    -   [CVE-2022-27384](https://ubuntu.com/security/CVE-2022-27384) <!-- medium -->
    -   [CVE-2022-27383](https://ubuntu.com/security/CVE-2022-27383) <!-- medium -->
    -   [CVE-2022-27382](https://ubuntu.com/security/CVE-2022-27382) <!-- medium -->
    -   [CVE-2022-27381](https://ubuntu.com/security/CVE-2022-27381) <!-- medium -->
    -   [CVE-2022-27380](https://ubuntu.com/security/CVE-2022-27380) <!-- medium -->
    -   [CVE-2022-27379](https://ubuntu.com/security/CVE-2022-27379) <!-- medium -->
    -   [CVE-2022-27378](https://ubuntu.com/security/CVE-2022-27378) <!-- medium -->
    -   [CVE-2022-27377](https://ubuntu.com/security/CVE-2022-27377) <!-- medium -->
    -   [CVE-2022-27376](https://ubuntu.com/security/CVE-2022-27376) <!-- medium -->
    -   [CVE-2022-21427](https://ubuntu.com/security/CVE-2022-21427) <!-- medium -->
    -   [CVE-2021-46669](https://ubuntu.com/security/CVE-2021-46669) <!-- low -->
    -   [CVE-2018-25032](https://ubuntu.com/security/CVE-2018-25032) <!-- medium -->


### [[USN-5740-1](https://ubuntu.com/security/notices/USN-5740-1)] X.Org X Server vulnerabilities {#usn-5740-1-x-dot-org-x-server-vulnerabilities}

-   2 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM), Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2022-3551](https://ubuntu.com/security/CVE-2022-3551) <!-- medium -->
    -   [CVE-2022-3550](https://ubuntu.com/security/CVE-2022-3550) <!-- medium -->


### [[USN-5736-1](https://ubuntu.com/security/notices/USN-5736-1)] ImageMagick vulnerabilities {#usn-5736-1-imagemagick-vulnerabilities}

-   17 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM), Bionic (18.04 LTS), Kinetic (22.10)
    -   [CVE-2022-32547](https://ubuntu.com/security/CVE-2022-32547) <!-- medium -->
    -   [CVE-2022-32546](https://ubuntu.com/security/CVE-2022-32546) <!-- medium -->
    -   [CVE-2022-32545](https://ubuntu.com/security/CVE-2022-32545) <!-- medium -->
    -   [CVE-2022-28463](https://ubuntu.com/security/CVE-2022-28463) <!-- medium -->
    -   [CVE-2022-1114](https://ubuntu.com/security/CVE-2022-1114) <!-- medium -->
    -   [CVE-2021-4219](https://ubuntu.com/security/CVE-2021-4219) <!-- low -->
    -   [CVE-2021-39212](https://ubuntu.com/security/CVE-2021-39212) <!-- low -->
    -   [CVE-2021-3574](https://ubuntu.com/security/CVE-2021-3574) <!-- medium -->
    -   [CVE-2021-20313](https://ubuntu.com/security/CVE-2021-20313) <!-- low -->
    -   [CVE-2021-20312](https://ubuntu.com/security/CVE-2021-20312) <!-- low -->
    -   [CVE-2021-20309](https://ubuntu.com/security/CVE-2021-20309) <!-- low -->
    -   [CVE-2021-20246](https://ubuntu.com/security/CVE-2021-20246) <!-- low -->
    -   [CVE-2021-20245](https://ubuntu.com/security/CVE-2021-20245) <!-- low -->
    -   [CVE-2021-20244](https://ubuntu.com/security/CVE-2021-20244) <!-- low -->
    -   [CVE-2021-20243](https://ubuntu.com/security/CVE-2021-20243) <!-- low -->
    -   [CVE-2021-20241](https://ubuntu.com/security/CVE-2021-20241) <!-- low -->
    -   [CVE-2021-20224](https://ubuntu.com/security/CVE-2021-20224) <!-- medium -->


### [[USN-5741-1](https://ubuntu.com/security/notices/USN-5741-1)] Exim vulnerability {#usn-5741-1-exim-vulnerability}

-   1 CVEs addressed in Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2022-3559](https://ubuntu.com/security/CVE-2022-3559) <!-- medium -->


### [[USN-5742-1](https://ubuntu.com/security/notices/USN-5742-1)] JBIG-KIT vulnerability {#usn-5742-1-jbig-kit-vulnerability}

-   1 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM), Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2017-9937](https://ubuntu.com/security/CVE-2017-9937) <!-- negligible -->


### [[USN-5743-1](https://ubuntu.com/security/notices/USN-5743-1)] LibTIFF vulnerability {#usn-5743-1-libtiff-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM)
    -   [CVE-2022-3970](https://ubuntu.com/security/CVE-2022-3970) <!-- medium -->


### [[USN-5744-1](https://ubuntu.com/security/notices/USN-5744-1)] libICE vulnerability {#usn-5744-1-libice-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM), Bionic (18.04 LTS)
    -   [CVE-2017-2626](https://ubuntu.com/security/CVE-2017-2626) <!-- low -->


### [[USN-5745-1](https://ubuntu.com/security/notices/USN-5745-1), [USN-5745-2](https://ubuntu.com/security/notices/USN-5745-2)] shadow vulnerability &amp; regression {#usn-5745-1-usn-5745-2-shadow-vulnerability-and-regression}

-   1 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM), Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2013-4235](https://ubuntu.com/security/CVE-2013-4235) <!-- low -->
-   Upstream introduced a change in file-system handling in `useradd` that required
    newer glibc - broke on older Ubuntu releases so that update has been reverted
    for now on those releases - still is in place on Ubuntu 22.04 LTS / 22.10


### [[USN-5689-2](https://ubuntu.com/security/notices/USN-5689-2)] Perl vulnerability {#usn-5689-2-perl-vulnerability}

-   1 CVEs addressed in Kinetic (22.10)
    -   [CVE-2020-16156](https://ubuntu.com/security/CVE-2020-16156) <!-- medium -->


### [[USN-5746-1](https://ubuntu.com/security/notices/USN-5746-1)] HarfBuzz vulnerability {#usn-5746-1-harfbuzz-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM)
    -   [CVE-2015-9274](https://ubuntu.com/security/CVE-2015-9274) <!-- low -->


### [[USN-5747-1](https://ubuntu.com/security/notices/USN-5747-1)] Bind vulnerabilities {#usn-5747-1-bind-vulnerabilities}

-   2 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM)
    -   [CVE-2016-6170](https://ubuntu.com/security/CVE-2016-6170) <!-- low -->
    -   [CVE-2016-2775](https://ubuntu.com/security/CVE-2016-2775) <!-- medium -->


### [[USN-5748-1](https://ubuntu.com/security/notices/USN-5748-1)] Sysstat vulnerability {#usn-5748-1-sysstat-vulnerability}

-   1 CVEs addressed in Bionic (18.04 LTS), Focal (20.04 LTS), Jammy (22.04 LTS), Kinetic (22.10)
    -   [CVE-2022-39377](https://ubuntu.com/security/CVE-2022-39377) <!-- medium -->


### [[USN-5728-3](https://ubuntu.com/security/notices/USN-5728-3)] Linux kernel (GCP) vulnerabilities {#usn-5728-3-linux-kernel--gcp--vulnerabilities}

-   12 CVEs addressed in Bionic (18.04 LTS)
    -   [CVE-2022-42719](https://ubuntu.com/security/CVE-2022-42719) <!-- medium -->
    -   [CVE-2022-40768](https://ubuntu.com/security/CVE-2022-40768) <!-- medium -->
    -   [CVE-2022-39188](https://ubuntu.com/security/CVE-2022-39188) <!-- medium -->
    -   [CVE-2022-3635](https://ubuntu.com/security/CVE-2022-3635) <!-- medium -->
    -   [CVE-2022-3625](https://ubuntu.com/security/CVE-2022-3625) <!-- medium -->
    -   [CVE-2022-3028](https://ubuntu.com/security/CVE-2022-3028) <!-- medium -->
    -   [CVE-2022-29901](https://ubuntu.com/security/CVE-2022-29901) <!-- medium -->
    -   [CVE-2022-2978](https://ubuntu.com/security/CVE-2022-2978) <!-- medium -->
    -   [CVE-2022-2153](https://ubuntu.com/security/CVE-2022-2153) <!-- medium -->
    -   [CVE-2022-20422](https://ubuntu.com/security/CVE-2022-20422) <!-- medium -->
    -   [CVE-2022-41222](https://ubuntu.com/security/CVE-2022-41222) <!-- high -->
    -   [CVE-2022-42703](https://ubuntu.com/security/CVE-2022-42703) <!-- high -->
-   2 high priority vulnerabilities both found by Jann Horn (GPZ)
    -   UAF in handling of anonymous VMA mappings
    -   UAF in memory management subsytem handling of TLBs
    -   both could be exploited by a local attacker to crash the kernel or get
        possible code execution within the kernel and hence escalate privileges


### [[USN-5749-1](https://ubuntu.com/security/notices/USN-5749-1)] libsamplerate vulnerability {#usn-5749-1-libsamplerate-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM)
    -   [CVE-2017-7697](https://ubuntu.com/security/CVE-2017-7697) <!-- low -->


### [[USN-5750-1](https://ubuntu.com/security/notices/USN-5750-1)] GnuTLS vulnerability {#usn-5750-1-gnutls-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM)
    -   [CVE-2021-4209](https://ubuntu.com/security/CVE-2021-4209) <!-- low -->


### [[USN-5718-2](https://ubuntu.com/security/notices/USN-5718-2)] pixman vulnerability {#usn-5718-2-pixman-vulnerability}

-   1 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM)
    -   [CVE-2022-44638](https://ubuntu.com/security/CVE-2022-44638) <!-- medium -->


## Goings on in Ubuntu Security Community {#goings-on-in-ubuntu-security-community}


### A look at Elastic Security Labs Global Threat Report {#a-look-at-elastic-security-labs-global-threat-report}

-   <https://www.elastic.co/pdf/elastic-global-threat-report-vol-1-2022.pdf>
-   Summarises the findings of the Elastic telemetry, which incorporates data from
    their various products like Endgame, Endpoint and Security solution.
-   54% of malware on Windows, 39% on Linux, 6% on MacOS
-   Of those, top 10 are:
    -   Meterpreter, Gafgyt, Mirai, Camelot, Generic, Dofloo, BPFDoor, Ransomexx,
        Neshta, Getshell
        -   We covered BPFDoor [previously]({{< relref "episode-161#bpfdoor-malware-targeting-linux-and-solaris-06-08" >}})
    -   Of these 80% are trojan-based, 11% are cryptominers, 4% ransomware
        -   Trojans commonly used to deploy stager and dropper binaries as part of
            wider intrusion effort
        -   Cryptominers generally mining Monero - mostly composed of XMRig family
-   Also covers details on Windows and MacOS - interestingly Windows still has
    lots of CobaltStrike, Metasploit and MimiKatz which are all ostensibly
    red-team tools - also see lots of keyloggers as well as credential stealers
    (crypto wallets)
-   Mapped behaviour against MITRE ATT&amp;CK - 34% doing defense evasion, 22%
    execution, 10% credential access, 8% persistence, 7% C², 6% privesc and 4%
    initial access
    -   of this, masquerading (as another legitimate process) and system binary
        proxy execution (using existing system binaries to perform malicious
        actions) accounts for 72% of defense evasion techniques
-   Then dive into more detail on execution techniques (mostly native command and
    scripting interpreters - think PowerShell, Windows Script Host etc) and
    abusing Windows Management Instrumentation (WMI) - but won't go too much into
    this here as this is the Ubuntu Security Podcast, not Windows ;)
-   Also cover metrics from the various public clouds - AWS had 57% of detections
    whilst GCP and Azure each had ~22% - why does AWS have so much more? AWS has
    at least ⅓ of the global cloud market share whilst Azure has 20% and GCP only
    11%
    -   Also perhaps AWS users prefer to use Elastic?
-   Activities they see most in the clouds are Credential Access, Persistence,
    Defense Evasion, Initial Access
-   58% of initial access attempts use brute-force combined with password spraying
-   Report then breaks down each cloud to look at the activities mostly performed in each
    -   AWS - access token stealing is top, Azure showed a large usage of valid
        account access to then attempt to retrieve other access tokens or do
        phishing, whilst for Google service account abuse was the top
    -   Perhaps is more indicative of what each cloud is used for - ie AWS general
        purpose, whilst Azure is AD and managed services, and Google is service
        workers
-   Finally, the report does a deep dive on 4 different threat samples and then
    has forecasts and recommendations based on those
    -   Of these most are windows specific, but one does predict that Linux VMs used
        for backend DevOps in cloud environments will be an increased target
    -   This is not really surprising nor novel, and most OSS devs would likely
        expect this threat given the nature of modern CI/CD pipelines and the
        follow-up threat to code integrity / supply chain security etc (ie if an
        attacker can compromise these machines can then tamper with source code /
        build artefacts etc)
-   As always, requires organisations to have a good security posture and practice
    good security hygiene - configure for least privilege, audit what you have,
    deploy defense-in-depth solutions, monitoring and logging so can help detect
    and have good incident response etc
    -   simple things too - deploy MFA, install security updates etc


## Get in contact {#get-in-contact}

-   [security@ubuntu.com](mailto:security@ubuntu.com)
-   [#ubuntu-security on the Libera.Chat IRC network](https://libera.chat)
-   [ubuntu-hardened mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
-   [Security section on discourse.ubuntu.com](https://discourse.ubuntu.com/c/security)
-   [@ubuntusecurity@fosstodon.org](https://fosstodon.org/@ubuntusecurity), [@ubuntu_sec on twitter](https://twitter.com/ubuntu_sec),
