+++
title = "Episode 236"
description = """
  The long awaited preview of snapd-based AppArmor file prompting is finally
  seeing the light of day, plus we cover the recent 24.04.1 LTS release and the
  podcast officially moves to a fortnightly cycle.
  """
date = 2024-09-06T19:50:00+09:30
lastmod = 2024-09-06T19:51:48+09:30
draft = false
weight = 1001
episode_image = "img/usp_logo_500.png"
explicit = "no"
podcast_file = "USP_E236.mp3"
podcast_duration = 1103
podcast_bytes = 18852490
permalink = "https://ubuntusecuritypodcast.org/episode-236/"
guid = "4428df5db1d81db94dedbf11924c70b41b7bd60a4c1aa7a2465591be0039ce48267a396e6f4e4e5cef6853ad990c7e4d0fff0e3514fc942cfa84d567084724bc"
+++

## Overview {#overview}

The long awaited preview of snapd-based AppArmor file prompting is finally
seeing the light of day, plus we cover the recent 24.04.1 LTS release and the
podcast officially moves to a fortnightly cycle.


## This week in Ubuntu Security Updates {#this-week-in-ubuntu-security-updates}

45 unique CVEs addressed


### [[USN-6972-4](https://ubuntu.com/security/notices/USN-6972-4)] Linux kernel (Oracle) vulnerabilities {#usn-6972-4-linux-kernel--oracle--vulnerabilities}

-   18 CVEs addressed in Xenial ESM (16.04 ESM), Bionic ESM (18.04 ESM)
    -   [CVE-2023-52470](https://ubuntu.com/security/CVE-2023-52470) <!-- low -->
    -   [CVE-2024-26687](https://ubuntu.com/security/CVE-2024-26687) <!-- medium -->
    -   [CVE-2024-36901](https://ubuntu.com/security/CVE-2024-36901) <!-- medium -->
    -   [CVE-2024-26654](https://ubuntu.com/security/CVE-2024-26654) <!-- medium -->
    -   [CVE-2024-26679](https://ubuntu.com/security/CVE-2024-26679) <!-- medium -->
    -   [CVE-2024-39484](https://ubuntu.com/security/CVE-2024-39484) <!-- medium -->
    -   [CVE-2023-52806](https://ubuntu.com/security/CVE-2023-52806) <!-- medium -->
    -   [CVE-2023-52760](https://ubuntu.com/security/CVE-2023-52760) <!-- medium -->
    -   [CVE-2024-35955](https://ubuntu.com/security/CVE-2024-35955) <!-- medium -->
    -   [CVE-2023-52629](https://ubuntu.com/security/CVE-2023-52629) <!-- medium -->
    -   [CVE-2024-26600](https://ubuntu.com/security/CVE-2024-26600) <!-- medium -->
    -   [CVE-2024-36940](https://ubuntu.com/security/CVE-2024-36940) <!-- medium -->
    -   [CVE-2024-39292](https://ubuntu.com/security/CVE-2024-39292) <!-- medium -->
    -   [CVE-2023-52644](https://ubuntu.com/security/CVE-2023-52644) <!-- medium -->
    -   [CVE-2024-35835](https://ubuntu.com/security/CVE-2024-35835) <!-- medium -->
    -   [CVE-2024-26903](https://ubuntu.com/security/CVE-2024-26903) <!-- medium -->
    -   [CVE-2024-24860](https://ubuntu.com/security/CVE-2024-24860) <!-- low -->
    -   [CVE-2024-22099](https://ubuntu.com/security/CVE-2024-22099) <!-- medium -->


### [[USN-6982-1](https://ubuntu.com/security/notices/USN-6982-1)] Dovecot vulnerabilities {#usn-6982-1-dovecot-vulnerabilities}

-   2 CVEs addressed in Noble (24.04 LTS)
    -   [CVE-2024-23185](https://ubuntu.com/security/CVE-2024-23185) <!-- medium -->
    -   [CVE-2024-23184](https://ubuntu.com/security/CVE-2024-23184) <!-- medium -->


### [[USN-6983-1](https://ubuntu.com/security/notices/USN-6983-1)] FFmpeg vulnerability {#usn-6983-1-ffmpeg-vulnerability}

-   1 CVEs addressed in Xenial ESM (16.04 ESM), Bionic ESM (18.04 ESM), Focal (20.04 LTS), Jammy (22.04 LTS), Noble (24.04 LTS)
    -   [CVE-2024-32230](https://ubuntu.com/security/CVE-2024-32230) <!-- medium -->


### [[USN-6984-1](https://ubuntu.com/security/notices/USN-6984-1)] WebOb vulnerability {#usn-6984-1-webob-vulnerability}

-   1 CVEs addressed in Focal (20.04 LTS), Jammy (22.04 LTS), Noble (24.04 LTS)
    -   [CVE-2024-42353](https://ubuntu.com/security/CVE-2024-42353) <!-- medium -->


### [[USN-6973-4](https://ubuntu.com/security/notices/USN-6973-4)] Linux kernel (Raspberry Pi) vulnerabilities {#usn-6973-4-linux-kernel--raspberry-pi--vulnerabilities}

-   9 CVEs addressed in Bionic ESM (18.04 ESM)
    -   [CVE-2023-52760](https://ubuntu.com/security/CVE-2023-52760) <!-- medium -->
    -   [CVE-2023-52629](https://ubuntu.com/security/CVE-2023-52629) <!-- medium -->
    -   [CVE-2021-46926](https://ubuntu.com/security/CVE-2021-46926) <!-- medium -->
    -   [CVE-2024-26921](https://ubuntu.com/security/CVE-2024-26921) <!-- high -->
    -   [CVE-2024-26929](https://ubuntu.com/security/CVE-2024-26929) <!-- medium -->
    -   [CVE-2024-36901](https://ubuntu.com/security/CVE-2024-36901) <!-- medium -->
    -   [CVE-2024-39484](https://ubuntu.com/security/CVE-2024-39484) <!-- medium -->
    -   [CVE-2024-26830](https://ubuntu.com/security/CVE-2024-26830) <!-- medium -->
    -   [CVE-2024-24860](https://ubuntu.com/security/CVE-2024-24860) <!-- low -->


### [[USN-6981-2](https://ubuntu.com/security/notices/USN-6981-2)] Drupal vulnerabilities {#usn-6981-2-drupal-vulnerabilities}

-   3 CVEs addressed in Trusty ESM (14.04 ESM)
    -   [CVE-2020-28949](https://ubuntu.com/security/CVE-2020-28949) <!-- high -->
    -   [CVE-2020-28948](https://ubuntu.com/security/CVE-2020-28948) <!-- medium -->
    -   [CVE-2020-13671](https://ubuntu.com/security/CVE-2020-13671) <!-- high -->
-   2 of these are in the CISA KEV - [Discussion of CISA KEV from Episode 231]({{< relref "episode-231#discussion-of-cisa-kev" >}})


### [[USN-6986-1](https://ubuntu.com/security/notices/USN-6986-1)] OpenSSL vulnerability {#usn-6986-1-openssl-vulnerability}

-   1 CVEs addressed in Jammy (22.04 LTS), Noble (24.04 LTS)
    -   [CVE-2024-6119](https://ubuntu.com/security/CVE-2024-6119) <!-- medium -->


### [[USN-6987-1](https://ubuntu.com/security/notices/USN-6987-1)] Django vulnerabilities {#usn-6987-1-django-vulnerabilities}

-   2 CVEs addressed in Bionic ESM (18.04 ESM), Focal (20.04 LTS), Jammy (22.04 LTS), Noble (24.04 LTS)
    -   [CVE-2024-45231](https://ubuntu.com/security/CVE-2024-45231) <!-- low -->
    -   [CVE-2024-45230](https://ubuntu.com/security/CVE-2024-45230) <!-- medium -->


### [[USN-6988-1](https://ubuntu.com/security/notices/USN-6988-1)] Twisted vulnerabilities {#usn-6988-1-twisted-vulnerabilities}

-   2 CVEs addressed in Trusty ESM (14.04 ESM), Xenial ESM (16.04 ESM), Bionic ESM (18.04 ESM), Focal (20.04 LTS), Jammy (22.04 LTS), Noble (24.04 LTS)
    -   [CVE-2024-41810](https://ubuntu.com/security/CVE-2024-41810) <!-- medium -->
    -   [CVE-2024-41671](https://ubuntu.com/security/CVE-2024-41671) <!-- medium -->


### [[USN-6985-1](https://ubuntu.com/security/notices/USN-6985-1)] ImageMagick vulnerabilities {#usn-6985-1-imagemagick-vulnerabilities}

-   11 CVEs addressed in Trusty ESM (14.04 ESM)
    -   [CVE-2019-12979](https://ubuntu.com/security/CVE-2019-12979) <!-- low -->
    -   [CVE-2019-12978](https://ubuntu.com/security/CVE-2019-12978) <!-- low -->
    -   [CVE-2019-12976](https://ubuntu.com/security/CVE-2019-12976) <!-- negligible -->
    -   [CVE-2019-12975](https://ubuntu.com/security/CVE-2019-12975) <!-- negligible -->
    -   [CVE-2019-12974](https://ubuntu.com/security/CVE-2019-12974) <!-- low -->
    -   [CVE-2019-11598](https://ubuntu.com/security/CVE-2019-11598) <!-- low -->
    -   [CVE-2019-11597](https://ubuntu.com/security/CVE-2019-11597) <!-- low -->
    -   [CVE-2019-11472](https://ubuntu.com/security/CVE-2019-11472) <!-- low -->
    -   [CVE-2019-11470](https://ubuntu.com/security/CVE-2019-11470) <!-- low -->
    -   [CVE-2019-10650](https://ubuntu.com/security/CVE-2019-10650) <!-- medium -->
    -   [CVE-2019-10131](https://ubuntu.com/security/CVE-2019-10131) <!-- low -->


## Goings on in Ubuntu Security Community {#goings-on-in-ubuntu-security-community}


### Ubuntu 24.04.1 LTS released (02:55) {#ubuntu-24-dot-04-dot-1-lts-released--02-55}

-   On 29th August - <https://lists.ubuntu.com/archives/ubuntu-announce/2024-August/000304.html>
-   <https://discourse.ubuntu.com/t/ubuntu-24-04-lts-noble-numbat-release-notes/39890>
-   Discussed high level features previously in [Ubuntu 24.04 LTS (Noble Numbat) released from Episode 227]({{< relref "episode-227#ubuntu-24-dot-04-lts--noble-numbat--released--14-27" >}})
    -   New security features / improvements:
        -   Unprivileged user namespace restrictions
        -   Binary hardening
        -   AppArmor 4
        -   Disabling of old TLS versions
        -   Upstream Kernel Security Features
            -   Intel shadow stack support
            -   Secure virtualisation with AMD SEV-SNP and Intel TDX
            -   Strict compile-time bounds checking
-   Initially offered upgrades from 22.04 but this has been [pulled just recently](https://lists.ubuntu.com/archives/ubuntu-release/2024-September/006225.html)
    due to [reports](https://bugs.launchpad.net/ubuntu/+source/ubuntu-release-upgrader/+bug/2078720) of a critical bug in the ubuntu-release-upgrader package and
    its interaction with the apt solver - essentially resulting in packages like
    linux-headers being in an broken state since it would remove some packages
    that were seen as obsolete but which were still required due to other packages
    depending on them
    -   likely will not be fixed until early next week


### Ubuntu Security Center with snapd-based AppArmor home file access prompting preview (05:45) {#ubuntu-security-center-with-snapd-based-apparmor-home-file-access-prompting-preview--05-45}

-   <https://news.itsfoss.com/ubuntu-security-center-near-stable/>
-   Details the new Desktop Security Center application
    -   Written by the Ubuntu Desktop team - new application built using Flutter +
        Dart etc and published a snap
    -   Eventually this will allow to manage various security related things like
        full-disk encryption, enabling/usage of Ubuntu Pro, Firewall control and
        finally for snap permission prompting
        -   this last feature is the only one currently supported - has a single
            toggle which is to enable "snaps to ask for system permissions" -
            aka. snapd-based AppArmor prompting
        -   and then once this is enabled, allows the specific permissions to be
            futher fine-tuned

{{< figure src="/img/desktop-security-center-main.png" >}}

-   What is AppArmor?
-   AppArmor policies - and MAC systems in general are static - policy defined by
    sysadmin etc
-   Not well suited for dynamic applications that are controlled by a user - like
    desktop / CLI etc - can't know in advance every possible file a user may want
    to open in say Firefox so have to grant access to all files in home directory
    just in case
-   Ideally system would only allow files that the user explicitly chooses -
    number of ways this can be done, [XDG Portals](https://flatpak.github.io/xdg-desktop-portal/docs/) one such way - using Powerbox
    concept pioneered in tools from the object-capability based security community
    like CapDesk/Polaris and [Plash](http://plash.beasts.org/powerbox.html) (principle of least-authority shell) - access
    is mediated by a privileged component that acts with the users whole authority
    to then delegate some of that authority to the application - seen say in the
    file-chooser dialog with portals - this runs outside of the scope of the
    application itself and so has the full, unrestricted access to the system to
    allow a file to be chosen - then the application is then just given a
    file-descriptor to the file to grant it the access (or similar)
-   This only works in the case of applications that open files interactively -
    can't allow the user to explicitly grant access to the configuration file that
    gets loaded from a well-known path at startup in a server application etc
-   One way to handle that case is to alert the user and explicitly prompt them
    for that access - and this is currently how this new prompting feature works
-   When the feature is enabled, the usual broad-based access rules for the `home`
    interface in snapd get tagged with a prompt attribute - any access then which
    would normally be allowed is instead delegated to a trusted helper application
    which displays a dialog to the user asking them to explicitly allow such
    access

{{< figure src="/img/desktop-security-center-prompt.png" >}}

-   since this happens directly in the system-call path within the kernel, the
    application itself is unaware that this is happening - but is just suspended
    whilst waiting for the users response - and then assuming they grant the
    access it proceeds as normal (or if they deny then the application gets a
    permission denied error)
-   Completely transparent to the application and supports any kind of file-access
    regardless of which API might be used (unlike portals which only support the
    regular file-chooser scenario)
-   Allows tighter control of what files a snap is granted access to - and can be
    managed by the user in the Security Center later to revoke any such permission
    that they granted

![](/img/desktop-security-center-manage.png)
![](/img/desktop-security-center-manage-home.png)
![](/img/desktop-security-center-manage-home-rules-for-snap.png)

-   Has been in development for a long time, and is certainly not a new concept -
    seccomp has supported this via the [`seccomp_unotify`](https://manpages.ubuntu.com/manpages/noble/man2/seccomp_unotify.2.html) interface - allows to
    delegate seccomp decisions to userspace in a very similar manner - existed
    since the 5.5 kernel released in January 2020
-   Even before that, prototype LSMs existed which implemented this kind of
    functionality (<https://sourceforge.net/projects/pulse-lsm/> /
    <https://crpit.scem.westernsydney.edu.au/confpapers/CRPITV81Murray.pdf>)
    <!-- even one developed in 2008 by some bloke called Alex Murray -->
-   Can test this now on an up-to-date 24.04 or 24.10 install
    -   Need to use snapd from the latest/edge channel and then install both the
        `desktop-security-center` snap as well as the `prompting-client` snap
    -   Launch Security Center and toggle the option
-   Note this is experimental but has undergone a fair amount of internal testing
-   Very exciting to see this finally available in this pre-release stage - has
    been talked about since at least [2018](https://forum.snapcraft.io/t/classic-confinement-for-ubuntu-watch-packages-snap/3834/9)
-   Give it a spin and provide feedback - I would suggest to use the link in the
    security center application itself for this but it is not working currently -
    instead report via a Github issue on the [desktop-security-center](https://github.com/canonical/desktop-security-center/issues) project


## Get in contact {#get-in-contact}

-   [security@ubuntu.com](mailto:security@ubuntu.com)
-   [#ubuntu-security on the Libera.Chat IRC network](https://libera.chat)
-   [ubuntu-hardened mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
-   [Security section on discourse.ubuntu.com](https://discourse.ubuntu.com/c/security)
-   [@ubuntusecurity@fosstodon.org](https://fosstodon.org/@ubuntusecurity), [@ubuntu_sec on twitter](https://twitter.com/ubuntu_sec)
